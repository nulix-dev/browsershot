import {
  ConsoleMessage,
  ExceptionOutput,
  FailedRequest,
  Output,
  PageError,
  RedirectHistory,
  RequestList,
} from './types'

/**
 * Class with all outputs generated by puppeteer
 *
 * All present data is always relative to the last browser call.
 *
 * This object contains:
 *
 * - consoleMessages: messages generated with console calls
 * - requestsList: list of all requests made
 * - failedRequests: list of all failed requests
 * - result: result of the last operation called
 * - exception: string representation of the exception generated, if any
 * - pageErrors: list of all page errors generated during the current command
 * - redirectHistory: list of all redirect in the page
 */
export class ChromiumResult {
  protected result: string

  protected exception?: ExceptionOutput

  protected consoleMessages?: ConsoleMessage[]

  protected requestsList?: RequestList[]

  protected failedRequests?: FailedRequest[]

  protected pageErrors?: PageError[]

  protected redirectHistory?: RedirectHistory[]

  constructor(output: Output) {
    this.result = output.result || ''
    this.exception = output.exception
    this.consoleMessages = output.consoleMessages
    this.requestsList = output.requestsList
    this.failedRequests = output.failedRequests
    this.pageErrors = output.pageErrors
    this.redirectHistory = output.redirectHistory
  }

  getResult(): string {
    return this.result
  }

  getException() {
    return this.exception
  }

  getConsoleMessages() {
    return this.consoleMessages
  }

  getRequestsList() {
    return this.requestsList
  }

  getFailedRequests() {
    return this.failedRequests
  }

  getPageErrors() {
    return this.pageErrors
  }

  getRedirectHistory() {
    return this.redirectHistory
  }
}
